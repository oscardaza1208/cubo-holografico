<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Candado 3D • Anti‑Phishing (Comultrasan)</title>

  <!-- A‑Frame (CDN principal + fallback) -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script>
    if (!window.AFRAME) {
      var s=document.createElement('script');
      s.src='https://unpkg.com/aframe@1.5.0/dist/aframe.min.js';
      document.head.appendChild(s);
    }
  </script>

  <style>
    :root{
      --verde-oscuro:#006B3F;   /* Aproximación Pantone 323 U */
      --verde-claro:#78BE20;    /* Aproximación Pantone 368 C */
      --fondo:#07110E;          /* Fondo profundo verdoso */
      --padBottom:max(12px, env(safe-area-inset-bottom));
    }
    html,body{height:100%; margin:0; background:var(--fondo);}
    /* Tarjeta inferior en colores corporativos (no tapa el candado) */
    .banner-bottom{
      position: fixed; left:50%; transform: translateX(-50%);
      bottom: calc(10px + var(--padBottom)); z-index:10; width:min(960px,92vw);
      background: linear-gradient(135deg, var(--verde-claro) 0%, #9BDD48 100%);
      color:#0b2a16; padding:14px 18px; border-radius:16px;
      box-shadow: 0 18px 38px rgba(0,0,0,.35), 0 6px 14px rgba(0,0,0,.18);
      font: 600 15px/1.45 "Segoe UI", Roboto, system-ui, -apple-system, Arial, sans-serif;
      border:3px solid rgba(255,255,255,.35);
      animation: pop-in .45s ease-out both;
    }
    .b-title{display:flex; align-items:center; gap:10px; font-weight:900; font-size:18px; margin-bottom:6px;}
    .badge{
      display:inline-flex; align-items:center; gap:6px; font-weight:900; font-size:12px;
      background:#E53935; color:#fff; padding:3px 10px; border-radius:999px;
      box-shadow:0 3px 10px rgba(229,57,53,.45);
    }
    .tips{margin:0; padding-left:18px;}
    .tips li{margin:3px 0;}
    @keyframes pop-in{from{transform:translate(-50%,10px) scale(.98); opacity:.0} to{transform:translate(-50%,0) scale(1); opacity:1}}
    /* El lienzo 3D ocupa toda la pantalla; la tarjeta queda abajo */
    a-scene{position: fixed; inset: 0;}
  </style>
</head>
<body>

  <!-- ESCENA 3D (sin cámara / sin aro inferior) -->
  <a-scene renderer="antialias:true; colorManagement:true" background="color: #07110E">
    <!-- Luces principales con acento verde corporativo -->
    <a-entity light="type: ambient; color:#b7c8bf; intensity:1.0"></a-entity>
    <a-entity light="type: directional; color:#ffffff; intensity:0.9" position="1 2 1"></a-entity>

    <!-- Luz que orbita (acento en verde claro) -->
    <a-entity id="orbital" position="0 1.35 -3"
              animation="property: rotation; to: 0 360 0; loop:true; dur: 5000; easing: linear">
      <a-entity light="type: point; color:#78BE20; intensity:0.9; distance:4" position="1 0.3 0"></a-entity>
    </a-entity>

    <!-- ===== Candado 3D (primitivas) en paleta Comultrasan ===== -->
    <a-entity id="candado" position="0 1.35 -3" scale="1 1 1"
              animation__spin="property: rotation; to: 0 360 0; loop:true; dur: 8500; easing: linear"
              animation__pulse="property: scale; dir: alternate; to: 1.07 1.07 1.07; dur: 1400; loop:true; easing: easeInOutSine">

      <!-- Arco metálico con leve brillo verdoso -->
      <a-torus radius="0.45" radius-tubular="0.06" position="0 0.55 0"
               material="color:#D5E5DB; metalness:0.95; roughness:0.2; emissive:#78BE20; emissiveIntensity:0.08"></a-torus>
      <!-- Soportes del arco -->
      <a-cylinder radius="0.12" height="0.20" position="-0.43 0.25 0"
                  material="color:#D5E5DB; metalness:0.95; roughness:0.25"></a-cylinder>
      <a-cylinder radius="0.12" height="0.20" position="0.43 0.25 0"
                  material="color:#D5E5DB; metalness:0.95; roughness:0.25"></a-cylinder>

      <!-- Cuerpo (bloque principal) en verde claro corporativo -->
      <a-box width="1.2" height="1.1" depth="0.5" position="0 -0.2 0"
             material="color:#78BE20; metalness:0.25; roughness:0.85"></a-box>

      <!-- Placa y ranura en verde oscuro corporativo -->
      <a-box width="0.52" height="0.22" depth="0.04" position="0 -0.2 0.28"
             material="color:#006B3F; metalness:0.25; roughness:0.55"></a-box>
      <a-box width="0.08" height="0.04" depth="0.02" position="0 -0.2 0.30"
             material="color:#032417"></a-box>
    </a-entity>

    <!-- Partículas sutiles que ascienden (verdes) -->
    <a-entity id="sparks">
      <a-sphere radius="0.014" color="#78BE20" position="-0.5 0.6 -3"
                material="opacity:0.85" animation="property: position; to: -0.5 1.8 -3; dur: 2400; loop:true; easing: easeOutCubic"></a-sphere>
      <a-sphere radius="0.012" color="#9BDD48" position="0.6 0.5 -3"
                material="opacity:0.8" animation="property: position; to: 0.6 1.7 -3; dur: 2100; loop:true; easing: easeOutCubic; delay: 350"></a-sphere>
      <a-sphere radius="0.01" color="#00C853" position="0.1 0.7 -3"
                material="opacity:0.8" animation="property: position; to: 0.1 1.9 -3; dur: 2600; loop:true; easing: easeOutCubic; delay: 700"></a-sphere>
      <a-sphere radius="0.013" color="#64DD17" position="-0.2 0.4 -3"
                material="opacity:0.85" animation="property: position; to: -0.2 1.6 -3; dur: 2200; loop:true; easing: easeOutCubic; delay: 1100"></a-sphere>
    </a-entity>

    <!-- Cámara fija -->
    <a-entity position="0 1.6 0" camera look-controls="enabled:false"></a-entity>
  </a-scene>

  <!-- Tarjeta con el mensaje (abajo, tono corporativo, no tapa el 3D) -->
  <div class="banner-bottom" role="region" aria-label="Consejos Anti‑Phishing">
    <div class="b-title"><span class="badge">⚠ PHISHING</span><span>Protege tu información</span></div>
    <ul class="tips">
      <li><b>Verifica</b> remitente y <b>dominio</b> antes de responder.</li>
      <li><b>No</b> abras enlaces ni archivos sospechosos.</li>
      <li><b>Desconfía</b> de urgencias, premios o solicitudes inusuales.</li>
    </ul>
  </div>

  <!-- Interacciones táctiles: arrastrar (rotar) y pellizcar (zoom) -->
  <script>
    window.addEventListener('load', function(){
      var el = document.getElementById('candado');
      var obj = el.object3D;
      var sceneEl = document.querySelector('a-scene');

      function onCanvas(cb){
        if (sceneEl.renderer && sceneEl.canvas) return cb(sceneEl.canvas);
        sceneEl.addEventListener('render-target-loaded', ()=> cb(sceneEl.canvas));
      }

      onCanvas(function(canvas){
        var isDown=false, startX=0, startRotY=0;
        var pinch=false, startDist=0, startScale=1;
        var inertia=0, lastX=0, raf=null;

        function d(t){ var dx=t[0].clientX-t[1].clientX, dy=t[0].clientY-t[1].clientY; return Math.hypot(dx,dy); }
        function clamp(v,min,max){ return Math.max(min, Math.min(max,v)); }

        // Rotación por arrastre (1 dedo / mouse)
        canvas.addEventListener('pointerdown', e=>{
          isDown=true; pinch=false; startX=e.clientX; lastX=e.clientX; startRotY=obj.rotation.y;
          canvas.setPointerCapture(e.pointerId);
        });
        canvas.addEventListener('pointermove', e=>{
          if(!isDown || pinch) return;
          var dx = e.clientX - startX;
          obj.rotation.y = startRotY + dx * 0.01;
          inertia = (e.clientX - lastX) * 0.004;
          lastX = e.clientX;
        });
        canvas.addEventListener('pointerup', e=>{
          if(isDown){ isDown=false; canvas.releasePointerCapture(e.pointerId); }
        });

        // Inercia suave al soltar
        function tick(){
          if (Math.abs(inertia) > 0.0005) {
            obj.rotation.y += inertia;
            inertia *= 0.96;
            raf = requestAnimationFrame(tick);
          } else { cancelAnimationFrame(raf); raf=null; }
        }
        setInterval(()=>{ if(!raf && Math.abs(inertia)>0.0005) tick(); }, 60);

        // Pellizco (zoom 2 dedos)
        canvas.addEventListener('touchstart', e=>{
          if(e.touches.length===2){
            pinch=true; isDown=false; startDist = d(e.touches);
            var s = el.getAttribute('scale'); startScale = s.x;
          }
        }, {passive:true});
        canvas.addEventListener('touchmove', e=>{
          if(pinch && e.touches.length===2){
            var factor = d(e.touches)/startDist;
            var newS = clamp(startScale * factor, 0.75, 1.7);
            el.setAttribute('scale', {x:newS, y:newS, z:newS});
          }
        }, {passive:true});
        canvas.addEventListener('touchend', ()=>{ pinch=false; }, {passive:true});
      });
    });
  </script>

  <!-- Aviso si el visor 3D no cargó (por caché/red corporativa) -->
  <script>
    setTimeout(()=>{
      if (!window.AFRAME || !document.querySelector('canvas')) {
        alert('No se pudo cargar el visor 3D. Recarga (Ctrl+F5) o abre en incógnito. En red corporativa, puede que el CDN esté bloqueado.');
      }
    }, 2200);
  </script>
</body>
</html>
